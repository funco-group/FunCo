# 가상 스레드

- 코틀린은 자바와 같이 싱글 코어 스레드인데 성능이 월등히 좋음

- 플랫폼 스레드
    - 하드웨어 종속적, 시스템 종속적
    - 처리속도 느림
- RX-Java, Spring-webflux
    - 전면적으로 비동기 채택
        - 데이터의 정합성이 깨진다는 문제점
        - 정합성을 보완하기 위해 함수형 프로그래밍 적용
            - 성능 저하가 문제점
    - 기존 자바의 문제점 보완
    - 기본적으로 자바는 블로킹 언어
- 가상 스레드
    - 10 pumped 기존 스레드가 가지고 있던 성능에 10배 뻥튀기
    - 플랫폼 스레드와 1 : N
    - 기존의 자바와 문법이 전혀 다르지 않음
    - 기존 스레드 → 가상 스레드
    - 현재 쓰고 있던 비용에서(동일한 비용에서) 성능이 10배 이상 향상되게 쓸 수 있음
        - 채택하지 않을 이유가 없음.
    - 운영체제에서는 존재를 인식할 수 없다 = 자바를 독립적으로 쓸 수 있다.
        - 기존 자바는 시스템 종속적
        - 자바이기 때문에 locking되는 건 똑같지만 운영체제에 어떠한 영향도 주지 않음
    - 운영체제와 자바의 고가용성이 보장이 됨
    - 경량화 된 스레드
    - 비동기로 사용해야 됨
        - 동기화로 사용할 수도 있음 (Ex.async await, promise)
    - WAS에서 사용할 수 있음
    - Gateway Server
        - webflux가 최고의 성능을 발휘
            - API 서버는 webflux로 하면 성능 낮음
        - 비동기로 사용할 수 있음
    - 가상 스레드와 플랫폼 스레드를 혼용해서 사용할 수 없음
        - java21은 둘다 지원
        - 둘다 사용하려면 WAS를 두개 사용해 신뢰성이 필요한 서버는 플랫폼 스레드를 사용하고 비동기 처리가 필요한 서버는 가상 스레드를 사용, 게이트웨이를 통해 두 서버를 동기
    - I/O 작업이 많이 일어났을 때 최적의 성능 향상
